{
  "version": 3,
  "sources": ["../@vaadin/field-base/src/delegate-focus-mixin.js"],
  "sourcesContent": ["/**\n * @license\n * Copyright (c) 2021 - 2022 Vaadin Ltd.\n * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n */\nimport { dedupingMixin } from '@polymer/polymer/lib/utils/mixin.js';\nimport { FocusMixin } from '@vaadin/component-base/src/focus-mixin.js';\nimport { TabindexMixin } from '@vaadin/component-base/src/tabindex-mixin.js';\n\n/**\n * A mixin to forward focus to an element in the light DOM.\n *\n * @polymerMixin\n * @mixes FocusMixin\n * @mixes TabindexMixin\n */\nexport const DelegateFocusMixin = dedupingMixin(\n  (superclass) =>\n    class DelegateFocusMixinClass extends FocusMixin(TabindexMixin(superclass)) {\n      static get properties() {\n        return {\n          /**\n           * Specify that this control should have input focus when the page loads.\n           */\n          autofocus: {\n            type: Boolean\n          },\n\n          /**\n           * A reference to the focusable element controlled by the mixin.\n           * It can be an input, textarea, button or any element with tabindex > -1.\n           *\n           * Any component implementing this mixin is expected to provide it\n           * by using `this._setFocusElement(input)` Polymer API.\n           *\n           * @protected\n           * @type {!HTMLElement}\n           */\n          focusElement: {\n            type: Object,\n            readOnly: true,\n            observer: '_focusElementChanged'\n          },\n\n          /**\n           * Indicates whether the element can be focused and where it participates in sequential keyboard navigation.\n           *\n           * By default, the host element does not have tabindex attribute. Instead, `focusElement` should have it.\n           * Toggling `tabindex` attribute on the host element propagates its value to `focusElement`.\n           *\n           * @protected\n           */\n          tabindex: {\n            type: Number,\n            value: undefined\n          }\n        };\n      }\n\n      constructor() {\n        super();\n\n        this._boundOnBlur = this._onBlur.bind(this);\n        this._boundOnFocus = this._onFocus.bind(this);\n      }\n\n      /** @protected */\n      ready() {\n        super.ready();\n\n        if (this.autofocus && !this.disabled) {\n          requestAnimationFrame(() => {\n            this.focus();\n            this.setAttribute('focus-ring', '');\n          });\n        }\n      }\n\n      /**\n       * @protected\n       * @override\n       */\n      focus() {\n        if (!this.focusElement || this.disabled) {\n          return;\n        }\n\n        this.focusElement.focus();\n        this._setFocused(true);\n      }\n\n      /**\n       * @protected\n       * @override\n       */\n      blur() {\n        if (!this.focusElement) {\n          return;\n        }\n        this.focusElement.blur();\n        this._setFocused(false);\n      }\n\n      /**\n       * @protected\n       * @override\n       */\n      click() {\n        if (this.focusElement && !this.disabled) {\n          this.focusElement.click();\n        }\n      }\n\n      /** @protected */\n      _focusElementChanged(element, oldElement) {\n        if (element) {\n          element.disabled = this.disabled;\n          this._addFocusListeners(element);\n          this.__forwardTabIndex(this.tabindex);\n        } else if (oldElement) {\n          this._removeFocusListeners(oldElement);\n        }\n      }\n\n      /**\n       * @param {HTMLElement} element\n       * @protected\n       */\n      _addFocusListeners(element) {\n        element.addEventListener('blur', this._boundOnBlur);\n        element.addEventListener('focus', this._boundOnFocus);\n      }\n\n      /**\n       * @param {HTMLElement} element\n       * @protected\n       */\n      _removeFocusListeners(element) {\n        element.removeEventListener('blur', this._boundOnBlur);\n        element.removeEventListener('focus', this._boundOnFocus);\n      }\n\n      /**\n       * Focus event does not bubble, so we dispatch it manually\n       * on the host element to support adding focus listeners\n       * when the focusable element is placed in light DOM.\n       * @param {FocusEvent} event\n       * @protected\n       */\n      _onFocus(event) {\n        event.stopPropagation();\n        this.dispatchEvent(new Event('focus'));\n      }\n\n      /**\n       * Blur event does not bubble, so we dispatch it manually\n       * on the host element to support adding blur listeners\n       * when the focusable element is placed in light DOM.\n       * @param {FocusEvent} event\n       * @protected\n       */\n      _onBlur(event) {\n        event.stopPropagation();\n        this.dispatchEvent(new Event('blur'));\n      }\n\n      /**\n       * @param {Event} event\n       * @return {boolean}\n       * @protected\n       * @override\n       */\n      _shouldSetFocus(event) {\n        return event.target === this.focusElement;\n      }\n\n      /**\n       * @param {boolean} disabled\n       * @param {boolean} oldDisabled\n       * @protected\n       * @override\n       */\n      _disabledChanged(disabled, oldDisabled) {\n        super._disabledChanged(disabled, oldDisabled);\n\n        if (this.focusElement) {\n          this.focusElement.disabled = disabled;\n        }\n\n        if (disabled) {\n          this.blur();\n        }\n      }\n\n      /**\n       * Override an observer from `TabindexMixin`.\n       * Do not call super to remove tabindex attribute\n       * from the host after it has been forwarded.\n       * @param {string} tabindex\n       * @protected\n       * @override\n       */\n      _tabindexChanged(tabindex) {\n        this.__forwardTabIndex(tabindex);\n      }\n\n      /** @private */\n      __forwardTabIndex(tabindex) {\n        if (tabindex !== undefined && this.focusElement) {\n          this.focusElement.tabIndex = tabindex;\n\n          // Preserve tabindex=\"-1\" on the host element\n          if (tabindex !== -1) {\n            this.tabindex = undefined;\n          }\n        }\n\n        if (this.disabled && tabindex) {\n          // If tabindex attribute was changed while component was disabled\n          if (tabindex !== -1) {\n            this.__lastTabIndex = tabindex;\n          }\n          this.tabindex = undefined;\n        }\n      }\n    }\n);\n"],
  "mappings": ";;;;;;;;;;;AAAA,AAgBO,IAAM,qBAAqB,cAChC,CAAC,eACC,MAAM,gCAAgC,WAAW,cAAc,UAAU,CAAC,EAAE;AAAA,aAC/D,aAAa;AACtB,WAAO;AAAA,MAIL,WAAW;AAAA,QACT,MAAM;AAAA,MACR;AAAA,MAYA,cAAc;AAAA,QACZ,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,MACZ;AAAA,MAUA,UAAU;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA,EAEA,cAAc;AACZ,UAAM;AAEN,SAAK,eAAe,KAAK,QAAQ,KAAK,IAAI;AAC1C,SAAK,gBAAgB,KAAK,SAAS,KAAK,IAAI;AAAA,EAC9C;AAAA,EAGA,QAAQ;AACN,UAAM,MAAM;AAEZ,QAAI,KAAK,aAAa,CAAC,KAAK,UAAU;AACpC,4BAAsB,MAAM;AAC1B,aAAK,MAAM;AACX,aAAK,aAAa,cAAc,EAAE;AAAA,MACpC,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EAMA,QAAQ;AACN,QAAI,CAAC,KAAK,gBAAgB,KAAK,UAAU;AACvC;AAAA,IACF;AAEA,SAAK,aAAa,MAAM;AACxB,SAAK,YAAY,IAAI;AAAA,EACvB;AAAA,EAMA,OAAO;AACL,QAAI,CAAC,KAAK,cAAc;AACtB;AAAA,IACF;AACA,SAAK,aAAa,KAAK;AACvB,SAAK,YAAY,KAAK;AAAA,EACxB;AAAA,EAMA,QAAQ;AACN,QAAI,KAAK,gBAAgB,CAAC,KAAK,UAAU;AACvC,WAAK,aAAa,MAAM;AAAA,IAC1B;AAAA,EACF;AAAA,EAGA,qBAAqB,SAAS,YAAY;AACxC,QAAI,SAAS;AACX,cAAQ,WAAW,KAAK;AACxB,WAAK,mBAAmB,OAAO;AAC/B,WAAK,kBAAkB,KAAK,QAAQ;AAAA,IACtC,WAAW,YAAY;AACrB,WAAK,sBAAsB,UAAU;AAAA,IACvC;AAAA,EACF;AAAA,EAMA,mBAAmB,SAAS;AAC1B,YAAQ,iBAAiB,QAAQ,KAAK,YAAY;AAClD,YAAQ,iBAAiB,SAAS,KAAK,aAAa;AAAA,EACtD;AAAA,EAMA,sBAAsB,SAAS;AAC7B,YAAQ,oBAAoB,QAAQ,KAAK,YAAY;AACrD,YAAQ,oBAAoB,SAAS,KAAK,aAAa;AAAA,EACzD;AAAA,EASA,SAAS,OAAO;AACd,UAAM,gBAAgB;AACtB,SAAK,cAAc,IAAI,MAAM,OAAO,CAAC;AAAA,EACvC;AAAA,EASA,QAAQ,OAAO;AACb,UAAM,gBAAgB;AACtB,SAAK,cAAc,IAAI,MAAM,MAAM,CAAC;AAAA,EACtC;AAAA,EAQA,gBAAgB,OAAO;AACrB,WAAO,MAAM,WAAW,KAAK;AAAA,EAC/B;AAAA,EAQA,iBAAiB,UAAU,aAAa;AACtC,UAAM,iBAAiB,UAAU,WAAW;AAE5C,QAAI,KAAK,cAAc;AACrB,WAAK,aAAa,WAAW;AAAA,IAC/B;AAEA,QAAI,UAAU;AACZ,WAAK,KAAK;AAAA,IACZ;AAAA,EACF;AAAA,EAUA,iBAAiB,UAAU;AACzB,SAAK,kBAAkB,QAAQ;AAAA,EACjC;AAAA,EAGA,kBAAkB,UAAU;AAC1B,QAAI,aAAa,UAAa,KAAK,cAAc;AAC/C,WAAK,aAAa,WAAW;AAG7B,UAAI,aAAa,IAAI;AACnB,aAAK,WAAW;AAAA,MAClB;AAAA,IACF;AAEA,QAAI,KAAK,YAAY,UAAU;AAE7B,UAAI,aAAa,IAAI;AACnB,aAAK,iBAAiB;AAAA,MACxB;AACA,WAAK,WAAW;AAAA,IAClB;AAAA,EACF;AACF,CACJ;",
  "names": []
}
